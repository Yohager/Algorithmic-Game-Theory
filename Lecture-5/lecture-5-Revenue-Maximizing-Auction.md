### Lecture 5

----

### Revenue Maximizing Auctions

前面的部分我们主要研究了在机制设计方面我们如何去寻找社会福利最大化或者说近似社会福利最大化的DSIC的机制或者非DSIC的机制。而事实上在进行一场拍卖之后，卖家最终的卖出东西的收益也是一个十分重要的点。这一部分我们探讨能够最大化卖家收益的机制。

5.1节探究利润最大化比社会福利最大化更难达到的原因以及贝叶斯环境的引入；5.2节探究期望收益最大化机制（虚拟社会福利最大化机制）；5.3节描述了在Sponsor Search Auction下的应用；5.4节做了一些证明。

#### 5.1 The Challenge of Revenue Maximiazation

假设一个简单的情境，只有一件商品同时只有一个卖家的情况下，这样的设定下我们的直接显示的DSIC机制空间很小，给定一个公式的价格$r$，对于卖家的收益可以表示为要么是$r$，要么是$0$. 而考虑社会福利最大化的情况就很简单了，直接将物品的价格设置为$0$，这样可以获得最大的社会福利。

因此我们会发现收益最大化的拍卖机制是根据bidders的私人估价的变化而变化的。这样看来社会福利最大化的拍卖就会显得很特殊，因为在同样的情境下，我们可以得到一种与输入无关的最友DSIC的机制。

下面引入贝叶斯分析，假定一个模型组成如下：

单参数的环境，假设存在一个常量$M$，使得所有的$x_i\leq M$，$(x_1,\cdots,x_n)\in X$是一个可行策略。

独立的分布：$F_1,\cdots ,F_n$，密度函数为$f_1,\cdots,f_n$，我们假设$v_i$服从$F_i$的分布

一个关键的假设是卖家提前知道每个bidder的估值分布。下面我们在这样的贝叶斯环境下进行思考，首先考虑最优机制，即我们认为在所有的DSIC机制中，我们找到一个能够期望卖家收益最大化的机制，这个机制就是我们认为的最优机制。

回到刚刚的单物品单人的拍卖问题上，当我们引入贝叶斯分析后，我们可以计算卖家的期望收益，可以表示为公示价格乘以bidder出价高于$r$的概率加上0乘以bidder出价低于$r$的概率。
$$
Rev = r\times (1-F(r))
$$
当我们知道了$F$的分布，我们就可以很容易求解得到最大的期望收益的值。我们称最优的公示价格为分布函数$F$的垄断价格。假设$F$的分布是一个在$[0,1]$上的均匀分布，那么我们很容易得到$Rev = r(1-r)$，所以垄断价格为$1/2$同时最大化的卖家收益为$1/4$.

当我们将这个情景扩展到多个bidder的情况下，我们会发现拍卖空间变得十分复杂，例如考虑单物品拍卖的情境下有两个人参与竞拍，两个人的估值均服从$[0,1]$上的均匀分布。我们机制可以设置为一个二价拍卖的机制。而期望的卖家收益为$1/3$.

下面给出证明：我们实际上知道目标可以转换为求一个新的随机变量$z=\min\{a,b\}$的期望值，其中$a,b$表示的是两个bidders，两个均服从[0,1]上的均匀分布。通过概率论的知识我们不难得到随机变量$z$的分布函数可以写为：$1-(1-F_a(z))(1-F_b(z))$，即：$-r^2+2r$. 概率密度函数写为：$-2r+2$

通过概率密度函数求解期望：
$$
E[z]=\int_{0}^{1}z(-2z+2)dz
$$
求得期望等于$1/3$即表示的是在二价拍卖的机制下，最大化卖家的期望收益值为$1/3$.

我们在上述的情景下进一步做一些改变，我们在这场两个人的二价拍卖中加入一个“保留价格”，这个保留价格设为$r$，如果所有的bidders的报价都低于$r$，那么所有人都无法得到这个商品，其他情况下将物品分配给报价最高者，赢家的payment等于第二高的价格或者$r$（哪一个高取哪一个）。假设$r=1/2$的情况下，最终得到的卖家的期望收益的值会从$1/3$提高到$5/12$.

#### 5.2 Characterization of Optimal DSIC Mechanism

在这个lecture中我们有一个终极目标，希望对于所有的单参数环境以及分布$F_1,\cdots,F_n$，我们希望给出一个最优的DSIC机制（最优表示卖家期望收益最大化）。

对于一个DSIC的机制$(\bold{x},\bold{p})$，其期望收益定义如下：
$$
\bold{E}_{\bold{v}\sim\bold{F}}\left[ \sum_{i=1}^{n} p_i(\bold{v}) \right]
$$
这个期望值是关于分布$\bold{F}=F_1\times \cdots \times F_n$. 

上面的式子十分抽象，无法直接找到最大化的方法，我们下面给出第二种形式，这种形式我们只考虑机制的分配规则而不考虑机制的支付规则，因此其优化会更加容易些。

第二种对于期望收益的形式使用到了“虚拟估值”的概念，对于一个竞拍者$i$，其估值分布定义为$F_i$同时这个估值的随机变量定义为$v_i$，那么他的虚拟估值我们定义如下：
$$
\varphi_i(v_i)=v_i-\frac{1-F_i(v_i)}{f_i(v_i)}
$$
如何理解这个虚拟估值的表达式呢？这个虚拟估值我们理解为卖家能从bidder手中实际获得的收益，这个实际收益分为两个部分，一个是理想条件下假设我提前知道所有bidder的情况我设置对应的价格所能获得的收益，而后面一部分可以理解为由于无法提前准确预知$v_i$而导致的无法避免的信息损失。·还有一种理解方式，我们可以认为$\varphi_i(v_i)$是一个“收益曲线”在$v_i$处的斜率表示，其中收益曲线表示的是从智能体处获得的期望收益关于交易成功概率的函数曲线，此时智能体的估值服从$F_i$.

基于上面给出的虚拟估值的定义，我们可以引入一些定理，一个单参数环境下，估值分布为$F_1,\cdots,F_n$，任意一个DSIC的机制，任意一个智能体$i$，以及其他智能体的$\bold{v}_{-i}$，我们有结论：
$$
\bold{E}_{v_i\sim F_i}[p_i(\bold{v})]=\bold{E}_{v_i\sim F_i}[\varphi_i(v_i)x_i(\bold{v})]
$$

上面的引理告诉我们一个结论，来自一个智能体的期望支付等于其期望虚拟估值。利用这个结论我们进一步得到：
$$
\bold{E}_{\bold{v}\sim \bold{F}}\left[\sum_{i=1}^np_i(\bold{v}) \right] = \bold{E}_{\bold{v}\sim \bold{F}}\left[ \sum_{i=1}^n\varphi_i(v_i)\cdot x_i(\bold{v}) \right]
$$
观察上面的式子，我们会发现如果将$\varphi_i(v_i)$替换为$v_i$我们得到的就是社会福利的期望值。因此我们进一步可以知道在满足DSIC的机制空间上对期望收益进行最大化，可以归约为在同一个空间上将期望虚拟福利进行最大化。

我们的目标的最大化收益，但是更进一步我们会发现解决这个问题的关键点还是在于如何找到合适的分配规则来最大化期望虚拟福利。这与社会福利最大化的分配规则设定是一致的。但是这里存在一个问题，虚拟福利最大化的规则是否单调？我们需要注意到这个分配规则是否单调还取决于估值分布，我们还需要确保估值分布关于$\varphi$是非减的，我们定义如果估值分布$F$所对应的虚拟估值函数$v-\frac{1-F(v)}{f(v)}$是关于$v$非减的，则我们称这个估值分布是正则分布。

> 虚拟福利最大化机制
>
> 假设每个agent的估值分布都是正则的。
>
> 1. 根据虚拟估值函数的表达式将真实估值$v_i$转换为对应的虚拟估值$\varphi_i(v_i)$.
> 2. 选择能够最大化虚拟福利$\sum_{i=1}^n\varphi_i(v_i)x_i$的可行的分配规则$(x_1,\cdots,x_n)$.
> 3. 根据迈尔森引理中给出的支付公式给出支付规则。

在任意单参数环境和正则分布$F_1,\cdots ,F_n$下，虚拟福利最大化机制是一个能够使得期望收益最大化的DSIC机制。 除此之外，虚拟福利最大化机制也是适用于BIC（贝叶斯激励相容）机制的。在所有的BIC机制上寻找最优期望收益的结果都会导出一个DSIC机制。

最优单物品拍卖：假设所有bidders的估值都是独立同分布的，同时假设他们的估值分布是严格正则的，那么虚拟福利最大化机制是将物品分配给虚拟估值最高且非负的竞拍者，如果这样的竞拍者存在的话，由于大家的虚拟估值函数都是一致的，所以虚拟估值最高的竞拍者就是真实估值最高的竞拍者。这样的分配规则和保留价格为$\varphi^{-1}(0)$的二价拍卖的分配方式是一致的。回到一开始的情景，我们不难发现，当所有的bidders都服从$[0,1]$上的均匀分布，那么我们最终设置的保留价格为$1/2$的二价拍卖就是最优的拍卖机制。

#### 5.3 案例分析

关键词搜索拍卖中的保留价格（略）。

#### 5.4 一些证明

回顾迈尔森引理中的支付规则：
$$
p_i(v_i,\bold{v}_{-i})=\int_{0}^{v_i}z\cdot x'_i(z,\bold{v}_{-i})dz
$$
给定一个bidder，假设为$i$，给定其他bidders的估值组合为$\bold{v}_{-i}$，我们可以写出$i$的期望支付公式：
$$
\begin{split}
\bold{E}_{v_i\sim F_i}[p_i(\bold{v})] &=\int_0^{v_{\max}}p_i(\bold{v})f_i(v_i)dv_i \\ 
&=\int_{0}^{v_\max}\left[\int_0^{v_i} z\cdot x'_i(z,\bold{v}_{-i})dz\right]f_i(v_i)dv_i
\end{split}
$$
交换积分顺序：
$$
\int_0^{v_{\max}}\left[\int_z^{v_\max}f_i(v_i)dv_i\right]z\cdot x'_i(z,\bold{v}_{-i})dz
$$
进一步化简：
$$
\int_0^{v_{max}}(1-F_i(z))\cdot z\cdot x'_i(z,\bold{v}_{-i})dz
$$
利用分部积分公式：
$$
\int u(x)v'(x)dx = u(x)v(x)-\int u'(x)v(x)dx
$$
我们对前面的式子可以进行改写：
$$
(1-F_i(z))\cdot z\cdot x_i(z,\bold{v}_{-i})|^{v_\max}_{0} - \int_{0}^{v_\max}(1-F_i(z)-zf_i(z))x_i(z,\bold{v}_{-i})dz
$$
进一步改写：
$$
\int_0^{v_{max}}\left(z-\frac{1-F_i(z)}{f_i(z)}\right) x_i(z,\bold{v}_{-i})f_i(z)dz
$$
写为期望的形式：
$$
E_{v_i\sim F_i}[\varphi_i(v_i)\cdot x_i(\bold{v})]
$$
至此我们完成证明：
$$
\bold{E}_{v_i\sim F_i}[p_i(\bold{v})] =\bold{E}_{v_i\sim F_i}[\varphi_i(v_i)\cdot x_i(\bold{v})]
$$

----

>与社会福利最大化不同，我们发现收益最大化机制会随着私人估值的变化而变化。
>
>假设每个智能体的估值都独立地服从某一个概率分布，且机制的设计者可以获取到这些分布的信息，我们就可以在这些分布下找到期望收益最高的机制即最优机制。
>
>记得虚拟估值的定义。
>
>记得估值分布正则的定义。
>
>单物品拍卖下，如果竞拍者的估值独立同分布于一种正则分布，那么最优拍卖就是一种带保留价格的二价拍卖。

